<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ziqiao Zhou" />

<meta name="date" content="2022-12-08" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Ziqiao Zhou</h4>
<h4 class="date">2022-12-08</h4>



<div id="hw1-2022-09-15" class="section level1">
<h1>Hw1-2022-09-15</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span></code></pre></div>
<pre><code>## Warning: package &#39;latex2exp&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span></code></pre></div>
<pre><code>## Warning: package &#39;pander&#39; was built under R version 4.2.2</code></pre>
<div id="question" class="section level2">
<h2>Question</h2>
<p>• Exercises 3.3, 3.7, 3.12, and 3.13 (pages 94-96, Statistical
Computating with R).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.3</h3>
<p>the probability inverse transformation F^(-1)(U) =
b/((1-u)^(1/a))</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#x &lt;- b/((1-u)^(1/a)) F(x) = 1-(b/x)^a, x&gt;=b&gt;0, a&gt;0</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span>((<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>), <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">8</span>,x<span class="sc">^</span><span class="dv">3</span>)))  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, .<span class="dv">01</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">8</span><span class="sc">/</span>y<span class="sc">^</span><span class="dv">3</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.7</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># acceptance-rejection method for Beta distribution</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>; j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>; y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>armethod_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b){</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">&gt;</span> u) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      <span class="co">#we accept x</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(j,y))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a=3,b=2 </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>; j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>; y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> <span class="dv">16</span><span class="sc">/</span><span class="dv">9</span><span class="sc">*</span>u) {</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(y)<span class="sc">==</span><span class="dv">12</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z,<span class="fu">dbeta</span>(z,<span class="at">shape1=</span><span class="dv">3</span>,<span class="at">shape2=</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level3">
<h3>3.12</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Exponential-Gamma mixture&quot;</span>)  </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-3" class="section level3">
<h3>3.13</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda) <span class="co"># the length of lambda = n</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(y)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">64</span>,(<span class="dv">2</span><span class="sc">+</span>y)<span class="sc">^</span><span class="dv">5</span>)))  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, .<span class="dv">01</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, <span class="dv">64</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">+</span>z)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw2-2022-09-23" class="section level1">
<h1>Hw2-2022-09-23</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>• Question about fast sorting algorithm and exercises 5.6, 5.7(pages
149-151, Statistical Computing with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="hw21" class="section level3">
<h3>Hw2,1</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the fast sorting algorithm</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fast_sorting <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">fast_sorting</span>(lower),a,<span class="fu">fast_sorting</span>(upper)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">=</span> t<span class="sc">*</span><span class="fu">log</span>(t)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  sum_time <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">=</span> <span class="fu">sample</span>(t[i])</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    sum_time <span class="ot">=</span> sum_time <span class="sc">+</span> <span class="fu">system.time</span>(<span class="fu">fast_sorting</span>(test))[<span class="dv">1</span>]</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">=</span> sum_time<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.0177 0.0366 0.0768 0.1180 0.1671</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(a<span class="sc">~</span>tn)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##  (Intercept)           tn 
## 2.693482e-05 1.826974e-07</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>tn, <span class="at">y=</span>a, <span class="at">main =</span> <span class="st">&quot;computation time - nlog(n)&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, fit<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>fit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>y, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
It is a linear relationship between computation time and nlog(n).</p>
</div>
<div id="section-4" class="section level3">
<h3>5.6&amp;5.7</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="co"># compute Cov</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cov,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] -0.23421</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>((<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>cov <span class="co"># compute Var</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(var,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.01565</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span>var<span class="sc">/</span>((<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">5</span>) <span class="co"># the percent reduction</span></span></code></pre></div>
<pre><code>## [1] 0.93534</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the calculated result</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(u<span class="sc">*</span>x) </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(MC1),<span class="fu">mean</span>(MC2)) <span class="co"># theta&#39;s estimate：MC method and antithetic variate approach</span></span></code></pre></div>
<pre><code>## [1] 1.718026 1.718080</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sd</span>(MC1)<span class="sc">^</span><span class="dv">2</span>,<span class="fu">sd</span>(MC2)<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">sd</span>(MC2)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sd</span>(MC1)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">7</span>) <span class="co"># theta&#39;s variance：MC method and antithetic variate approach</span></span></code></pre></div>
<pre><code>## [1] 0.0002483 0.0000080 0.9676254</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the theoretical value</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>var_antithetic <span class="ot">=</span> var<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>m)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>var_MC <span class="ot">=</span> ((<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>m</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(var_antithetic,var_MC,<span class="dv">1</span><span class="sc">-</span>var_antithetic<span class="sc">/</span>var_MC),<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 0.0000078 0.0002420 0.9676701</code></pre>
<p>The calculated result is close to the theoretical value.</p>
</div>
</div>
</div>
<div id="hw3-2022-09-16" class="section level1">
<h1>Hw3-2022-09-16</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>• Exercises 5.13, 5.15(pages 149-151, Statistical Computing with
R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-5" class="section level3">
<h3>5.13</h3>
<p><span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2}\)</span></p>
<p><span class="math inline">\(f_1(x)=e^{1-x}\)</span></p>
<p><span class="math inline">\(f_2(x)=\frac{1}{x^2}\)</span></p>
<p>We’ll just call it <span class="math inline">\(f_i\)</span> for the
method that uses <span class="math inline">\(f_i\)</span> as an
importance function.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The true value of the integral</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the method that uses f1 as an importance function</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x1) <span class="sc">/</span> <span class="fu">f1</span>(x1)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>I1_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="co"># the method that uses f2 as an importance function</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x2) <span class="sc">/</span> <span class="fu">f2</span>(x2)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>I2_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(I[[<span class="dv">1</span>]], I1_hat, I2_hat),<span class="dv">5</span>) <span class="co"># The true value of the integral and two estimations</span></span></code></pre></div>
<pre><code>## [1] 0.40063 0.40046 0.40038</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(sd1,sd2),<span class="dv">5</span>) <span class="co"># stand error of f1 and f2</span></span></code></pre></div>
<pre><code>## [1] 0.15773 0.30560</code></pre>
<p>The variance of <span class="math inline">\(f_1\)</span> is
smaller.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="fl">0.01</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">main=</span><span class="st">&#39;(A)&#39;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f1</span>(x), <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f2</span>(x), <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;green&quot;</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that in the plot, <span class="math inline">\(\frac{g(x)}{f_1(x)}\)</span> is smoother than
<span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span>. That’s why the
variance of <span class="math inline">\(f_1\)</span> is smaller.</p>
</div>
<div id="section-6" class="section level3">
<h3>5.15</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span>; k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># what if k is larger?</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  q[i] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>p[i]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>p[i<span class="sc">+</span><span class="dv">1</span>]))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  est[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M)))</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(M) <span class="co">#f3, inverse transform method</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> q[j] <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    T2[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  est[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> T2[<span class="dv">1</span>]<span class="sc">+</span>T2[<span class="dv">2</span>]<span class="sc">+</span>T2[<span class="dv">3</span>]<span class="sc">+</span>T2[<span class="dv">4</span>]<span class="sc">+</span>T2[<span class="dv">5</span>]</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">0.5257801</span>,<span class="fu">apply</span>(est,<span class="dv">2</span>,mean)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5258 0.5246 0.5248</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">0.0970314</span>,<span class="fu">apply</span>(est,<span class="dv">2</span>,sd)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.09703 0.00216 0.00049</code></pre>
<p>In this case, it can be seen that stratified sampling method is
better than importance sampling method.</p>
</div>
</div>
</div>
<div id="hw4-2022-10-09" class="section level1">
<h1>Hw4-2022-10-09</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>• Exercises 6.4, 6.8(pages 180-181, Statistical Computing with R) and
discussion.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>6.4</h3>
<p>Suppose <span class="math inline">\(Y=lnX\)</span>, it’s easy to know
that the 95% confidence interval for the parameter <span class="math inline">\(\mu_Y\)</span> is</p>
<p><span class="math inline">\(\left[ \bar{Y} -
\frac{S}{\sqrt{n}}t_{n-1}\left(\alpha/2\right) , \bar{Y} +
\frac{S}{\sqrt{n}}t_{n-1}\left(\alpha/2\right)\right]\)</span>,</p>
<p>Where, <span class="math inline">\(S^2=\frac{1}{n-1}\sum\limits_{i=1}^{n}\left(Y_i-\bar{Y}\right)^2\)</span>
is the sample variance.</p>
<p>Therefore, the 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math inline">\(\left[ exp\left\{ \bar{Y} -
\frac{S}{\sqrt{n}}t_{n-1}\left(\alpha/2\right) \right\}, exp\left\{
\bar{Y} + \frac{S}{\sqrt{n}}t_{n-1}\left(\alpha/2\right) \right\}
\right]\)</span>.</p>
<p>data generation</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lognormal_MC <span class="ot">&lt;-</span> <span class="cf">function</span>(n, ml, sl){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  DCL <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>);UCL <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, ml, sl)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    DCL[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> <span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sqrt</span>(n) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    UCL[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">+</span> <span class="fu">sd</span>(y)<span class="sc">/</span><span class="fu">sqrt</span>(n) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(DCL));U <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(UCL))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(y);<span class="fu">rm</span>(DCL);<span class="fu">rm</span>(UCL) <span class="co"># clear memory</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(D, U))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lognormal_MC</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">2</span>) <span class="co"># example</span></span></code></pre></div>
<pre><code>## [1] 0.4010465 2.5211515</code></pre>
</div>
<div id="section-8" class="section level3">
<h3>6.8</h3>
<p>data generation</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(X) <span class="co"># clear memory</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(Y) <span class="co"># clear memory</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>Ftest <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level =</span> <span class="fl">0.945</span>)[[<span class="dv">3</span>]]<span class="sc">&lt;</span><span class="fl">0.055</span>))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>data analysis</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>compare_power <span class="ot">&lt;-</span> <span class="cf">function</span>(m,n){</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  sum_c <span class="ot">=</span> sum_f <span class="ot">=</span><span class="dv">0</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    sum_c <span class="ot">=</span> sum_c <span class="sc">+</span> <span class="fu">count5test</span>(x, y)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    sum_f <span class="ot">=</span> sum_f <span class="sc">+</span> <span class="fu">Ftest</span>(x, y)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  power_c <span class="ot">&lt;-</span> sum_c<span class="sc">/</span>m</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  power_f <span class="ot">&lt;-</span> sum_f<span class="sc">/</span>m</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(x) <span class="co"># clear memory</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(y) <span class="co"># clear memory</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">c</span>(power_c,power_f))</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the power of the Count Five test, the power of F Test&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the power of the Count Five test, the power of F Test&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_power</span>(<span class="dv">1000</span>,<span class="dv">20</span>) <span class="co"># Compare the power of the Count Five test and F test for small sample size(n=20).</span></span></code></pre></div>
<pre><code>## [1] 0.280 0.398</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_power</span>(<span class="dv">1000</span>,<span class="dv">100</span>) <span class="co"># Compare the power of the Count Five test and F test for medium sample size(n=100).</span></span></code></pre></div>
<pre><code>## [1] 0.860 0.982</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_power</span>(<span class="dv">1000</span>,<span class="dv">1000</span>) <span class="co"># Compare the power of the Count Five test and F test for large sample size(n=1000).</span></span></code></pre></div>
<pre><code>## [1] 0.997 1.000</code></pre>
<p>It can be seen that the power of F test is greater than the power of
the Count Five test for small, medium and large sample sizes.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<div id="question3.1" class="section level4">
<h4>QUESTION3.1</h4>
<p>What is the corresponding hypothesis test problem?</p>
</div>
<div id="answer3.1" class="section level4">
<h4>ANSWER3.1</h4>
<p>Let <span class="math inline">\(Power_1\)</span> express the power of
the first method, <span class="math inline">\(Power_2\)</span> express
the power of the second method.</p>
<p>Simulation results for the first method is 0.651.</p>
<p>Simulation results for the second method is 0.676.</p>
<p><span class="math inline">\(H_0:Power_1=Power_2,H1:Power1\neq
Power2\)</span>.</p>
</div>
<div id="question3.2" class="section level4">
<h4>QUESTION3.2</h4>
<p>Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
</div>
<div id="answer3.2" class="section level4">
<h4>ANSWER3.2</h4>
<p>McNemar test. McNemar is a non-parametric method for 10000 paired
data, which is a 0-1 contingency table corresponding test (its content
is a binomial distribution). In addition, Z-test, two-sample t-test and
paired-t test are based on the normal distribution. So, we can’t use
them in this situation.</p>
<p>The problem can be written as the 2*2 contingency table test.</p>
<p>Therefore:<span class="math inline">\(H_0:n_{11}+n_{12}=n_{21}+n_{22}\)</span>.</p>
<p>The statistic of test is <span class="math inline">\(X =
\frac{(n_{12}-n_{21})^2}{n_{12}+n_{21}}\)</span> , and it is a
Chi-Squared distribution with <span class="math inline">\(df=1\)</span>
under <span class="math inline">\(H_0\)</span>.</p>
</div>
<div id="question3.3" class="section level4">
<h4>QUESTION3.3</h4>
<p>Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer3.3" class="section level4">
<h4>ANSWER3.3</h4>
<p>From the information, we don’t know the results of 10,000
experiments. Only the specific results of 10,000 experiments are
provided, we can get the contingency table. At present, we can’t say the
powers are different at 0.05 level.</p>
</div>
</div>
</div>
</div>
<div id="hw5-2022-10-14" class="section level1">
<h1>Hw5-2022-10-14</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>• Exercises 7.4, 7.5, 7.A(pages 212-213, Statistical Computing with
R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-9" class="section level3">
<h3>7.4</h3>
<p>Assume <span class="math inline">\(X_1,X_2,...,X_n i.i.d. \sim
Exp(\lambda)\)</span>. It has the pdf <span class="math inline">\(f(x,\lambda) = \lambda e^{- \lambda
x}\)</span>.</p>
<p>The likelihood function is <span class="math inline">\(L(\lambda;x_1,
... ,x_n) = \lambda ^ n e ^ {-n \overline x \lambda}\)</span>.</p>
<p>Then, <span class="math inline">\(\frac{\partial
ln(L)}{\partial{\lambda}} = \frac{n}{\lambda} - n \overline
x\)</span>.</p>
<p>Let it <span class="math inline">\(= 0\)</span>, we can get the MLE
of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda = \frac{1}{\overline X}\)</span>.</p>
<p>data generation</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>lambdastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  lambdastar[b] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(xstar)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">lambda.bootest =</span> <span class="fu">mean</span>(lambdastar), <span class="at">lambda.MLE =</span> lambda, <span class="at">bias =</span> <span class="fu">mean</span>(lambdastar) <span class="sc">-</span> lambda, <span class="at">se.boot =</span> <span class="fu">sd</span>(lambdastar))</span></code></pre></div>
<pre><code>## lambda.bootest     lambda.MLE           bias        se.boot 
##    0.010561175    0.009252120    0.001309054    0.004317109</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lambdastar) <span class="co"># clear memory</span></span></code></pre></div>
</div>
<div id="section-10" class="section level3">
<h3>7.5</h3>
<p>data generation</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  x_bar</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>bo <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x, <span class="at">statistic=</span>skewness, <span class="at">R =</span> R)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bo, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bo)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = skewness, R = R)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 0.5279583    37.67937</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bo, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.7, 181.4 )   ( 22.9, 168.8 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 193.3 )   ( 56.8, 227.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(bo) <span class="co"># clear memory</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci) <span class="co"># clear memory</span></span></code></pre></div>
<p>The CI calculated by the standard normal method is (33.7, 181.4). The
length of interval is 147.7.</p>
<p>The CI calculated by the basic method is (22.9, 168.8). The length of
interval is 145.9.</p>
<p>The CI calculated by the percentile method is (47.3, 193.3). The
length of interval is 146.0.</p>
<p>The CI calculated by BCa method is (56.8, 227.4). The length of
interval is 170.6.</p>
<p>Since the samples are not drawn from a normal distribution, the
locations of these confidence intervals on the parameter space may not
be the same. In addition, the distribution of X is not symmetric, which
may also lead to different confidence intervals. BCa interval is a
modified version of percentile CI, but it adjusts for both skewness and
bias. So it’s different from the other three results.</p>
</div>
<div id="a" class="section level3">
<h3>7.A</h3>
<p>data generation</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.percent <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  x_bar</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span>;sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># standard normal distribution</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma) </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(s, <span class="at">statistic=</span>skewness, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  ci.percent[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(t) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coverage.prob&quot;</span>, <span class="st">&quot;missed.left&quot;</span>, <span class="st">&quot;missed.right&quot;</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>t[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.norm[,<span class="dv">1</span>]),<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.basic[,<span class="dv">1</span>]),<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.percent[,<span class="dv">1</span>]))<span class="sc">/</span>m</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>t[,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.norm[,<span class="dv">2</span>]),<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.basic[,<span class="dv">2</span>]),<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.percent[,<span class="dv">2</span>]))<span class="sc">/</span>m</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>t[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>t[,<span class="dv">2</span>]<span class="sc">-</span>t[,<span class="dv">3</span>]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>##        coverage.prob missed.left missed.right
## normal        0.8977      0.0484       0.0539
## basic         0.8978      0.0482       0.0540
## perc          0.8961      0.0497       0.0542</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
</div>
</div>
<div id="hw6-2022-10-21" class="section level1">
<h1>Hw6-2022-10-21</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>• Exercises 7.8, 7.11, 8.2(pages 212-213, 242, Statistical Computing
with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level3">
<h3>7.8</h3>
<p>data generation</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">eigen</span>(sigma_hat)<span class="sc">$</span>values)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">eigen</span>(s)<span class="sc">$</span>values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">eigen</span>(s)<span class="sc">$</span>values)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sigma_hat</span></code></pre></div>
<pre><code>##          mec       vec       alg       ana       sta
## mec 305.7680 127.22257 101.57941 106.27273 117.40491
## vec 127.2226 172.84222  85.15726  94.67294  99.01202
## alg 101.5794  85.15726 112.88597 112.11338 121.87056
## ana 106.2727  94.67294 112.11338 220.38036 155.53553
## sta 117.4049  99.01202 121.87056 155.53553 297.75536</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bias) <span class="co">#jackknife estimate of bias</span></span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The jackknife estimate of standard error is 0.04955231. From the previous result for the bias, we have the estimated coefficient of variation</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>bias<span class="sc">/</span>se</span></code></pre></div>
<pre><code>## [1] 0.02157597</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
<div id="section-12" class="section level3">
<h3>7.11</h3>
<p>data generation</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG,<span class="at">quietly=</span><span class="cn">TRUE</span>); <span class="fu">attach</span>(ironslag)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)   <span class="co">#in DAAG ironslag</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    yhat1k <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    yhat1l <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[l]</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    e1[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat1k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat1l)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    yhat2k <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    yhat2l <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[l] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[l]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    e2[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat2k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat2l)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    logyhat3k <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    yhat3k <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3k)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    logyhat3l <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[l]</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    yhat3l <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3l)</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    e3[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat3k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat3l)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    logyhat4k <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    yhat4k <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4k)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    logyhat4l <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[l])</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    yhat4l <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4l)</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    e4[i] <span class="ot">&lt;-</span> ((magnetic[k] <span class="sc">-</span> yhat4k)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[l] <span class="sc">-</span> yhat4l)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(e1) <span class="co"># clear memory</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(e2) <span class="co"># clear memory</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(e3) <span class="co"># clear memory</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(e4) <span class="co"># clear memory</span></span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data.</p>
</div>
<div id="section-13" class="section level3">
<h3>8.2</h3>
<p>data generation</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">210</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>) {</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k];y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(cor0, reps) <span class="sc">&gt;=</span> cor0)</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.06000 0.08945</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>The p-value reported by cor.test is bigger than the achieved
significance level of the permutation test.</p>
</div>
</div>
</div>
<div id="hw7-2022-10-24" class="section level1">
<h1>Hw7-2022-10-24</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>• Exercises 9.4, 9.7(pages 212-213, 242, Statistical Computing with
R)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-14" class="section level3">
<h3>9.4</h3>
<p>data generation</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, x0, N) {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fu">abs</span>(y)))</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># degrees of freedom for target Student t dist.</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># number of candidate points rejected</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print(c(rw1$k, rw2$k, rw3$k, rw4$k))</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>rw1<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rw2<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rw3<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rw4<span class="sc">$</span>k<span class="sc">/</span>N),<span class="dv">3</span>)) <span class="co"># the acceptance rates of each chain</span></span></code></pre></div>
<pre><code>## [1] 0.982 0.829 0.520 0.201</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(rw1$x, type=&quot;l&quot;, xlab=&quot;sigma=0.05&quot;, ylab=&quot;X&quot;, ylim=range(rw1$x))</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(rw2$x, type=&quot;l&quot;, xlab=&quot;sigma=0.5&quot;, ylab=&quot;X&quot;, ylim=range(rw2$x))</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(rw3$x, type=&quot;l&quot;, xlab=&quot;sigma=2&quot;, ylab=&quot;X&quot;, ylim=range(rw3$x))</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(rw4$x, type=&quot;l&quot;, xlab=&quot;sigma=8&quot;, ylab=&quot;X&quot;, ylim=range(rw4$x))</span></span></code></pre></div>
<p>data generation</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>normal.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generates a Metropolis chain for Normal(0,1)</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and starting value X1</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fu">abs</span>(y)))</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma &lt;- 2 #parameter of proposal distribution</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># number of chains to generate</span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co"># length of chains</span></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a><span class="co"># choose overdispersed initial values</span></span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>sigma.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma) {</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the chains</span></span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">normal.chain</span>(sigma, n, x0[i])</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a><span class="co"># trace plots</span></span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">1</span>,],<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">2</span>,],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">3</span>,],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">4</span>,],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a><span class="co"># plot psi for the four chains</span></span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># restore default</span></span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sequence of R-hat statistics</span></span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma.chain(.05)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma.chain(.5)</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma.chain(2)</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sigma.chain(8)</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>It can be seen from the above results that the chain converges when
sigma=0.5, 2, 8. When sigma=0.05, mc list cannot converge in a short
time.</p>
<p>In the third plot (sigma = 2) the chain is mixing well and converging
to the target distribution after a short burn-in period.</p>
</div>
<div id="section-15" class="section level3">
<h3>9.7</h3>
<p>data generation</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize constants and parameters</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># length of chain</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co"># correlation</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co"># initialize</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">t</span>(X)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare sample statistics to parameters</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.8981412
## [2,] 0.8981412 1.0000000</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x),<span class="dv">3</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Means:  -0.044 -0.048</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Standard errors: &#39;</span>,<span class="fu">round</span>(<span class="fu">apply</span>(x,<span class="dv">2</span>,sd),<span class="dv">3</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Standard errors:  0.988 0.991</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Correlation coefficients: &#39;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>]),<span class="dv">3</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Correlation coefficients:  0.898</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>], <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="fu">c</span>(<span class="fu">expression</span>(X[<span class="dv">1</span>]),<span class="fu">expression</span>(X[<span class="dv">2</span>])), <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>] <span class="sc">~</span> x[,<span class="dv">1</span>])</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>L</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Coefficients:
## (Intercept)       x[, 1]  
##   -0.008759     0.901355</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.70536 -0.29345 -0.00029  0.29302  1.95050 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.008759   0.004599  -1.904   0.0569 .  
## x[, 1]       0.901355   0.004652 193.756   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4359 on 8998 degrees of freedom
## Multiple R-squared:  0.8067, Adjusted R-squared:  0.8066 
## F-statistic: 3.754e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Using F.test to check residuals, we can see the p-value &lt; 2.2e-16.
So, residuals agree with normal model.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#n &lt;- 10000</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#b &lt;- 1000</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">#psi &lt;- t(apply(Y, 1, cumsum))</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:nrow(psi))</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  psi[i,] &lt;- psi[i,] / (1:ncol(psi))</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Gelman.Rubin(psi))</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot psi for the four chains</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co">#for (i in 1:2)</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot(psi[i, (b+1):n], type=&quot;l&quot;, xlab=i, ylab=bquote(psi))</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,1)) # restore default</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the sequence of R-hat statistics</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co">#rhat &lt;- rep(0, n)</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co">#for (j in (b+1):n)</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="co">#  rhat[j] &lt;- Gelman.Rubin(psi[,1:j])</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(h=1.2, lty=2)</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>As we can see, the chain immediately converges.</p>
</div>
</div>
</div>
<div id="hw8-2022-11-04" class="section level1">
<h1>Hw8-2022-11-04</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>• Hw8.1&amp;8.2</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="hw8.1" class="section level3">
<h3>Hw8.1</h3>
<p>data generation</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Model &lt;- function(alpha, beta, gamma, N){</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  x &lt;- rnorm(N, 0, 1)</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  e_M &lt;- rnorm(N, 0, 1)</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  e_Y &lt;- rnorm(N, 0, 1)</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  m &lt;- alpha*x + e_M</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  y &lt;- beta*m + gamma*x + e_Y</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(data.frame(x, m, y))</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#t &lt;- function(x, m, y){</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  data &lt;- data.frame(x, m, y)</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Model_M &lt;- lm(m~x, data=data)</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  Model_Y &lt;- lm(y~m+x, data=data)</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  t &lt;- Model_M$coef[2]*Model_Y$coef[2]/sqrt(Model_M$coef[2]^2*(summary(Model_M)$coefficients[2,2])^2+Model_Y$coef[2]^2*(summary(Model_Y)$coefficients[2,2])^2)</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(as.numeric(t))</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation_Test_1 &lt;- function(data){</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- 10; B &lt;- 499</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  reps &lt;- numeric(B)</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in 1:B) {</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co">#    k &lt;- sample(1:N, size = N, replace = FALSE)</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co">#    x &lt;- data[k, 1]</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co">#    reps[i] &lt;- t(x, data$m, data$y)</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co">#  p_hat &lt;- (sum(abs(reps)&gt;abs(t(data$x, data$m, data$y)))+1)/(1+B)</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(p_hat&lt;0.05)</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation_Test_2 &lt;- function(data){</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- 10; B &lt;- 499</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="co">#  reps &lt;- numeric(B)</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in 1:B) {</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    k &lt;- sample(1:N, size = N, replace = FALSE)</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co">#    y &lt;- data[k, 3]</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    reps[i] &lt;- t(data$x, data$m, y)</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co">#  p_hat &lt;- (sum(abs(reps)&gt;abs(t(data$x, data$m, data$y)))+1)/(1+B)</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(p_hat&lt;0.05)</span></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation_Test_3 &lt;- function(data){</span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="co">#  N &lt;- 10; B &lt;- 499</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="co">#  reps &lt;- numeric(B)</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in 1:B) {</span></span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="co">#    k &lt;- sample(1:N, size = N, replace = FALSE)</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="co">#    m &lt;- data[k, 2]</span></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="co">#    reps[i] &lt;- t(data$x, m, data$y)</span></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a><span class="co">#  p_hat &lt;- (sum(abs(reps)&gt;abs(t(data$x, data$m, data$y)))+1)/(1+B)</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(p_hat&lt;0.05)</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="co">#simulation &lt;- function(alpha, beta, gamma=1, N=10){</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a><span class="co">#  Type_1_error &lt;- matrix(0, nrow = 3, ncol = 200)</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a><span class="co">#  for (i in 1:200) {</span></span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a><span class="co">#    data &lt;- Model(alpha, beta, gamma, N)</span></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a><span class="co">#    Type_1_error[1,i] &lt;- Permutation_Test_1(data)</span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a><span class="co">#    Type_1_error[2,i] &lt;- Permutation_Test_2(data)</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="co">#    Type_1_error[3,i] &lt;- Permutation_Test_3(data)</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(c(mean(Type_1_error[1,]),mean(Type_1_error[2,]),mean(Type_1_error[3,])))</span></span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(516)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#simulation1 &lt;- simulation(alpha=0, beta=0)</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#simulation2 &lt;- simulation(alpha=0, beta=1)</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#simulation3 &lt;- simulation(alpha=1, beta=0)</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation_Test &lt;- data.frame(Model1=simulation1, Model2=simulation2, Model3=simulation3)</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#row.names(Permutation_Test) &lt;- c(&quot;Permutation_Test_1&quot;, &quot;Permutation_Test_2&quot;, &quot;Permutation_Test_3&quot;)</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation_Test</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list=ls()) # clear memory</span></span></code></pre></div>
</div>
<div id="hw8.2" class="section level3">
<h3>Hw8.2</h3>
<p>data generation</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>gfo <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0, x1, x2, x3){</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>alpha_estimation <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0){</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>); x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N); x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, N, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="fu">gfo</span>(N, b1, b2, b3, f0, x1, x2, x3),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">5</span>))</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> solution<span class="sc">$</span>root</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,p)</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(d) <span class="co"># estimation of alpha</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>; b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.099842</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 0.010103</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## [1] 0.001009</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>## [1] 9.6e-05</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>), <span class="dv">10</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">c</span>(<span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.1</span>), <span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.01</span>), </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.001</span>), <span class="fu">alpha_estimation</span>(N, b1, b2, b3, <span class="fl">0.0001</span>)), <span class="dv">10</span>)    </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type=</span><span class="st">&quot;p&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Scatter Diagram&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;-log(f0)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;-log(alpha)&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
</div>
</div>
<div id="hw9-2022-11-11" class="section level1">
<h1>Hw9-2022-11-11</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>• One class work, 2.1.3 Exercise 4, 5; 2.3.1 Exercise 1, 2; 2.4.5
Exercise 1, 2, 3 (Advanced in R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="class-work" class="section level3">
<h3>Class work</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maximizing likelihood function</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>max_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lam){</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>v))))</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">uniroot</span>(max_likelihood, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))<span class="sc">$</span>root, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07197</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EM algorithm</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>lam <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-3</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>lam1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="dv">1</span>){</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  lam1 <span class="ot">&lt;-</span> lam1 <span class="sc">-</span> <span class="fu">max_likelihood</span>(lam)<span class="sc">/</span><span class="fu">length</span>(u) </span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(<span class="dv">1</span><span class="sc">/</span>lam1 <span class="sc">-</span> lam) <span class="sc">&lt;</span> eps) <span class="cf">break</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  lam <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lam1</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">iter =</span> i, <span class="at">lambda =</span> lam), <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##    iter  lambda 
## 2.00000 0.07197</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>We can see that the estimates for both maximizing likelihood function
and EM algorithm are 0.07197. So EM estimate equals to MLE.</p>
</div>
<div id="section-16" class="section level3">
<h3>2.1.3</h3>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>Vectors in R are divided into two categories, atomic and list. The
difference is that the former must have the same element type, and the
latter can be different. The former is represented by vector and
matrice, and the latter by list and data frame.</p>
<p>Since they are both vectors, ‘is.vector()’ cannot distinguish between
vectors and lists. Of course, we can’t convert a list into a vector
using ‘as.vector()’. If we want to convert a list to a vector, we should
use ‘unlist()’.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(<span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 1
## 
## [[1]][[2]]
## [1] 2
## 
## 
## [[2]]
## [1] 3 4</code></pre>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="st">&quot;1&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>If the two arguments are atomic vectors of different types, one is
coerced to the type of the other, the (decreasing) order of precedence
being character, complex, numeric, integer, logical and raw. So 1 == “1”
is true.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span> <span class="sc">&lt;</span> <span class="cn">FALSE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">==</span> <span class="cn">FALSE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>In numerical judgment, ‘FALSE’ stands for 0. This is why -1 &lt;
FALSE is true.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;one&quot;</span> <span class="sc">&lt;</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;one&quot;</span> <span class="sc">&gt;</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>If the two arguments are atomic vectors of different types, one is
coerced to the type of the other, the (decreasing) order of precedence
being character, complex, numeric, integer, logical and raw.</p>
<p>In this case, character takes precedence over integer. So “one” &lt;
2 is false.</p>
</div>
<div id="section-17" class="section level3">
<h3>2.3.1</h3>
<ol style="list-style-type: decimal">
<li>NULL. Because ‘dim’ is used on matrix, array, or data frame.</li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>TRUE</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="section-18" class="section level3">
<h3>2.4.5</h3>
<ol style="list-style-type: decimal">
<li><p>Names, dimensions, class.</p></li>
<li><p>Its elements will be coerced into a same type, following the
rule: logical &lt; integer &lt; double &lt; character.</p></li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name=</span><span class="fu">c</span>(<span class="st">&quot;Zhang San&quot;</span>, <span class="st">&quot;Li Si&quot;</span>, <span class="st">&quot;Wang Wu&quot;</span>), <span class="at">age=</span><span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">28</span>),</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">height=</span><span class="fu">c</span>(<span class="dv">182</span>, <span class="dv">164</span>, <span class="dv">175</span>))</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>##        name age height
## 1 Zhang San  30    182
## 2     Li Si  35    164
## 3   Wang Wu  28    175</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(d)</span></code></pre></div>
<pre><code>##      name        age  height
## [1,] &quot;Zhang San&quot; &quot;30&quot; &quot;182&quot; 
## [2,] &quot;Li Si&quot;     &quot;35&quot; &quot;164&quot; 
## [3,] &quot;Wang Wu&quot;   &quot;28&quot; &quot;175&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a data frame with 0 rows</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>test1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">character</span>(<span class="dv">0</span>), <span class="at">col2=</span><span class="fu">numeric</span>(<span class="dv">0</span>), <span class="at">col3=</span><span class="fu">logical</span>(<span class="dv">0</span>))</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>test1</span></code></pre></div>
<pre><code>## [1] col1 col2 col3
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(test1)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  3 variables:
##  $ col1: chr 
##  $ col2: num 
##  $ col3: logi</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>test2<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">0</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>test2<span class="ot">=</span><span class="fu">as.data.frame</span>(test2)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(test2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;col1&quot;</span>, <span class="st">&quot;col2&quot;</span>, <span class="st">&quot;col3&quot;</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>test2</span></code></pre></div>
<pre><code>## [1] col1 col2 col3
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(test2)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  3 variables:
##  $ col1: logi 
##  $ col2: logi 
##  $ col3: logi</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a data frame with 0 cols</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>test3<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">0</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>test3<span class="ot">=</span><span class="fu">as.data.frame</span>(test3)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(test3)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>, <span class="st">&quot;row3&quot;</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>test3</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(test3)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  0 variables</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a data frame with 0 rows and 0 cols</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
</div>
</div>
<div id="hw10-2022-11-18" class="section level1">
<h1>Hw10-2022-11-18</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>• Exercises 2 on page 204,Exercises 1 on page 213 (Advanced R) and
Gibbs Sampler.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercises-2" class="section level3">
<h3>Exercises 2</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tidyverse)</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">col2=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>), <span class="at">col3=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>scale01_apply <span class="ot">&lt;-</span> <span class="fu">apply</span>(d, <span class="dv">2</span>, scale01)</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>scale01_apply</span></code></pre></div>
<pre><code>##      col1 col2 col3
## [1,]  1.0  0.8  1.0
## [2,]  0.5  0.0  0.0
## [3,]  0.0  1.0  0.5</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">col2=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>), <span class="at">col3=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply(select_if(d2,is.numeric), scale01)</span></span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
<div id="exercises-1" class="section level3">
<h3>Exercises 1</h3>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>d_a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">col2=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>), <span class="at">col3=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>))</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>d_a</span></code></pre></div>
<pre><code>##   col1 col2 col3
## 1    1    1    1
## 2    2    3    4
## 3    3    5    7</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>sd_vapply <span class="ot">&lt;-</span> <span class="fu">vapply</span>(d_a, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>sd_vapply</span></code></pre></div>
<pre><code>## col1 col2 col3 
##    1    2    3</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>d_b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name=</span><span class="fu">c</span>(<span class="st">&quot;Zhang San&quot;</span>, <span class="st">&quot;Li Si&quot;</span>, <span class="st">&quot;Wang Wu&quot;</span>), <span class="at">age=</span><span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">28</span>),</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">height=</span><span class="fu">c</span>(<span class="dv">182</span>, <span class="dv">164</span>, <span class="dv">175</span>))</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>d_b</span></code></pre></div>
<pre><code>##        name age height
## 1 Zhang San  30    182
## 2     Li Si  35    164
## 3   Wang Wu  28    175</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(d_b[,<span class="fu">which</span>(<span class="fu">vapply</span>(</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  d_b,is.numeric,<span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>)))]</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  , sd, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      age   height 
## 3.605551 9.073772</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
</div>
<div id="gibbs-sampler" class="section level3">
<h3>Gibbs Sampler</h3>
<p>data generation</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">516</span>)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(mu1, mu2, sigma1, sigma2, rho, N, burn){</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co"># initialize</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">t</span>(X)</span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>result reporting</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../src/gibbsC.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;E:/
## zzq/StatComp22017/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="dv">10000</span>, <span class="dv">1000</span>),</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gibbscpp=</span><span class="fu">gibbsC</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="dv">10000</span>, <span class="dv">1000</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##       expr       lq   median      uq
## 1   gibbsR 37.59690 40.63655 45.1813
## 2 gibbscpp  2.21515  2.25810  2.4078</code></pre>
<p>Function gibbsC is much quicker than gibbsR.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">gibbsR</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="dv">10000</span>, <span class="dv">1000</span>), <span class="fu">gibbsC</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="dv">10000</span>, <span class="dv">1000</span>), <span class="at">main=</span><span class="st">&quot;qqplot&quot;</span>, <span class="at">xlab=</span><span class="st">&#39;R&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;Rcpp&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6Ojo6ZpA6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq2ZpC227a22/+2/9u2///bkDrbkJDbtmbbtpDb////tmb/25D/27b//7b//9v///99DFaxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHuElEQVR4nO3dC3viRBiG4enutqjFY1HL6rpRC0L+/w80ySRAaZN3Dt9kviHv42UXe0jI7SRMlxBMzSYzue+A9ggEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQKBygI4bc/9y9ak/viZfbclA//3wgUDn3gJtzYKAjp9X5u4Xu8kXt5sPf/5ozKcvZ6B/m//++NNL69OUnEgJULP1tmaDL29v+5t3zwNQZT/R3FwU0M6Yh5fj526DL283CB++1P80n+mB9qv2Y6P0uKxdrN+3Nv1udXHbPPVftkA9yvb8jYnTATQcX84Qrw2qZh/rPj98sf3EkoAO62Yfqi3K5e3BoNnrnjqb4YvtJ5YExBGEstvajI8TynCbx6Au+8i1vXgU2+JHsW4YpU4J0GnC046J7dt5kJ0evZ4HtZKLmQd1s+dPv59n0v3t5sNfvxnz3fVM+mf7M3aOnTQtQLbLo8p8h5nJCAQiEIhAIF1ACiMQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoFCgParJ/H7oTYfoMPanMr9hOdseY2gXXvaEkfQRId1e4rOWyBTXmmA6np79zw1gvQf83ubZEB1ZR5LBhpGTzqgZvx8LBPotG91/zr/lP+KjhtTHtArmsRAMy5Oqn7smF6IQFcNPj1Q6l1sxsVJNOBc/kGgUxdH5mEMJX6Yn3Vx0Z1GzXku23/BeQnCd0h2cbGNz50J1DbxuwWB2iZ+9yJQfenzztecFyJ5j3QBTf7mTqDrh63rrzovRuwOpVhceOhvfpYN5PA3Y4sGcvBZNJCLz5KBnHyWC2TcfBYL5OqzUCBnnoUCufMsE8jHJxVQZezFRupq5Ln5fEBePKmAqrvn+rBuL+CjDsjTJw3QcfPYfWwvv6ILyJcnEdBhbZ8w3N6/XAF53jvp/H1SjqCm7YOmERTAk+wY1LPYq0NFL06mIJ90j2J2JztutAB5zA1f/5z4N2ZZHF5fGM9SgEKHT70QoHCeZQDF+CwAKIonDKg7Dfr6quip1htbpE8I0K67amMVd+3GmYBieUKAjpvT7xFBa/Rcb1TxPgFAh+/t0NlFvchgDiABnpgRVGkfQSI+Qceg7teIavwUX9H1hq9BxCdkFxN5KU9qICGem50HifncJpAcz21OFCV9bnGiKMlzgxNF0eFT395EUdrn1iaK0jw3NlEUHz71bU0UE/AkmwcN72w1KigPlGL41MmeFzP9M4e74UbU4lxK5BME1D7Aj2552+mZ1fFDufTEPBFPEJCdANmTN95veG6+fjMZSLUVyXyCDtJ26yfmQXOPoIQ+QfMgu/VjpyV0XxvmAHMcg1LyBO1iduv3q4mD0GkuMDqZFHwcTuoTdJDer4yJfUMqsXlcWp7i/z4ouU8M0N/5f1lNzhMAVPXT49Ezf4TXO7WMGXy8gdq/LbMTxamZouB6JxYxh48v0HHz0M2Eot81MH6LZuHxBjqsH1ulb834NFp4vWM/P5OPP5B9s86o3ctrvSM/PhNPKFDkUxo+6333h+fzCQSK3cHigOb0KRBoVp4CgWb28Qc637scE0Uzt09hv4vNzlMW0PzDpy4KKAdPQUBZhk9dDlAmnmRAlRF9UW+u4VMne+JQ9EW9GXkSAcm+qDerTxqg8Rf1BiwuK0/SEVRLvKg37/Cpkx2DpF7Um5sn4aPY+y/q9dza/D6650H5edICXZzDELI4DTyKgRTsXfZ+iH/juRggLT5KgdTwKAVS5KPyUUyTj0Kg7HPnq7sj/o1RizPKeHQBGX08qoBU+igCUsmjCEipj1Yg2ZXFpAVIKY8OoIFFn06tAMiaqBw8XZmBXo0djT55gfrBo9knK9DpzfJO7+2lsIxAZvhHs09uoMsdTHYFUmUFskJKZfqyHoP082h4FFNe9omi9rIBFVMmIPc8TpTJuEgCSX6rbAQSWzGBpL6TQPMvkkCS3yobgcRWvFCgUiIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBMoF1F262+GKYDvHi4O6Ls/mca2tTEDHTbPZFb6mXHv5wp2DkOvy+qV6vL9KJqD9qnuHAXStIvvCIocLPzkuz3ZY6weywbHhtd0Oy7NV978WArRFW77/pt1i5/dCgcsbFqr/GNQ1eQF9+x3dkHAcGA7La2t32zKAdm7HaGcgh+W1tVebLwLI5f+3zy7mNn7sIlUDVXbCUrlsj8dB2ml5/erbXN+hJ9cIcnsPIeeHec/3JFI9grqm31vgnOtE0XV5ffqB+oGON71y+1XDeXk2/UDlRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUAEAhEIRCAQgUC6gbqTe33O75VPO1B35svO69wW2YoA6v/IUhFAEu9CHVoRQBxBY/UyfufXyaYdyO+MywRpB3pozz/Mt4MVAeR6BnSaSgCqt64nZyaoCKDDmg/z7zc8vrueRp8g3UAKIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgf4HZphXYEH5KS8AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<hr />
<center>
<font color="Black" size="5"><strong>Thank you for your
review.</strong></font>
</center>
<hr />
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
